<!DOCTYPE html>
<html lang="en"><head>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="02_supervised_learning_files/libs/clipboard/clipboard.min.js"></script>
<script src="02_supervised_learning_files/libs/quarto-html/tabby.min.js"></script>
<script src="02_supervised_learning_files/libs/quarto-html/popper.min.js"></script>
<script src="02_supervised_learning_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="02_supervised_learning_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="02_supervised_learning_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="02_supervised_learning_files/libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.8.25">

  <title>Supervised Learning</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="02_supervised_learning_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="02_supervised_learning_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="02_supervised_learning_files/libs/revealjs/dist/theme/quarto-9df06d9b3e1683bd31835b8738a1bbfc.css">
  <link href="02_supervised_learning_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="02_supervised_learning_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="02_supervised_learning_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="02_supervised_learning_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>
  
  <script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Supervised Learning</h1>

<div class="quarto-title-authors">
</div>

</section>
<section id="introduction" class="slide level2">
<h2>Introduction</h2>
<p>In the last chapter we looked at singular value decomposition and its applications like recommender systems. This was an example of <strong>unsupervised</strong> learning. Unsupervised learning is a collection of techniques in machine learning (ML) the goal of which is to extract information from unlabelled data.</p>
</section>
<section id="introduction-1" class="slide level2">
<h2>Introduction</h2>
<p>In this chapter we look at <strong>supervised learning</strong>. The goal of supervised learning is to predict a label of a sample given some input data. The two main types of problems are:</p>
<ol type="1">
<li>Classification, where we try to classify the data into <span class="math inline">\(n\)</span> classes (ex. classify pictures of pets into “dog”, “cat” and “other”).</li>
<li>Regression, where we try to predict a continuous variable (ex. predict a price of a product given its description).</li>
</ol>
</section>
<section id="introduction-2" class="slide level2">
<h2>Introduction</h2>
<p>There is also a third paradigm called <strong>reinforcement learning</strong> where the goal is to learn from experience. It is used to train computer agents to perform various tasks.</p>
</section>
<section id="introduction-3" class="slide level2">
<h2>Introduction</h2>
<p>In this chapter we will cover the main concepts of supervised learning.</p>
<p>To make things more interesting, we will do this by going over a possible workflow for creating a simple classification model.</p>
</section>
<section id="introduction-4" class="slide level2">
<h2>Introduction</h2>
<p>We will use the <a href="https://www.kaggle.com/datasets/yasserh/titanic-dataset">Titanic dataset</a>. This dataset has info on passengers of the Titanic and whether they survived the sinking.</p>
<div id="290ea2d9" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href=""></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href=""></a></span>
<span id="cb1-3"><a href=""></a>df <span class="op">=</span> pd.read_csv(<span class="st">"../data/titanic/titanic.csv"</span>, index_col<span class="op">=</span><span class="st">"PassengerId"</span>) <span class="co"># Load data from csv file into a pandas dataframe</span></span>
<span id="cb1-4"><a href=""></a>df.head(<span class="dv">5</span>) <span class="co"># Take first 5 rows from dataframe</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Survived</th>
<th data-quarto-table-cell-role="th">Pclass</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Sex</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">SibSp</th>
<th data-quarto-table-cell-role="th">Parch</th>
<th data-quarto-table-cell-role="th">Ticket</th>
<th data-quarto-table-cell-role="th">Fare</th>
<th data-quarto-table-cell-role="th">Cabin</th>
<th data-quarto-table-cell-role="th">Embarked</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">PassengerId</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">1</th>
<td>0</td>
<td>3</td>
<td>Braund, Mr. Owen Harris</td>
<td>male</td>
<td>22.0</td>
<td>1</td>
<td>0</td>
<td>A/5 21171</td>
<td>7.2500</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2</th>
<td>1</td>
<td>1</td>
<td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
<td>female</td>
<td>38.0</td>
<td>1</td>
<td>0</td>
<td>PC 17599</td>
<td>71.2833</td>
<td>C85</td>
<td>C</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">3</th>
<td>1</td>
<td>3</td>
<td>Heikkinen, Miss. Laina</td>
<td>female</td>
<td>26.0</td>
<td>0</td>
<td>0</td>
<td>STON/O2. 3101282</td>
<td>7.9250</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">4</th>
<td>1</td>
<td>1</td>
<td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
<td>female</td>
<td>35.0</td>
<td>1</td>
<td>0</td>
<td>113803</td>
<td>53.1000</td>
<td>C123</td>
<td>S</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">5</th>
<td>0</td>
<td>3</td>
<td>Allen, Mr. William Henry</td>
<td>male</td>
<td>35.0</td>
<td>0</td>
<td>0</td>
<td>373450</td>
<td>8.0500</td>
<td>NaN</td>
<td>S</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="data" class="slide level2">
<h2>Data</h2>
<p>Explanation of some columns, others should be obvious:</p>
<ul>
<li>Survived: 1 - survived the sinking; 0 - did not</li>
<li>Pclass: passenger class</li>
<li>SibSp: number of siblings and spouses on the ship</li>
<li>Parch: number of parents and children on the ship</li>
<li>Embarked: the port that the passenger embarked from</li>
</ul>
</section>
<section id="objective" class="slide level2">
<h2>Objective</h2>
<p>The goal for today is to build a model that is able to predict whether a passenger survived the sinking of the Titanic.</p>
</section>
<section id="workflow" class="slide level2">
<h2>Workflow</h2>
<p>Typical workflow for a classification problem is:</p>
<ol type="1">
<li>Data exploration / cleaning.</li>
<li>Feature engineering.</li>
<li>Choosing a model and training it.</li>
<li>Evaluating the trained model and then iterating steps 2, 3 and 4.</li>
</ol>
<p>We will now go over this step by step.</p>
</section>
<section id="data-exploration-and-cleaning" class="slide level2">
<h2>Data exploration and cleaning</h2>
<p>The first step is to familiarize yourself with the data. Figure out what the input data represents and then see what is going to be useful for the task at hand.</p>
<p>For example, in our case data is as follows:</p>
<div id="bf1abb89" class="cell" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href=""></a>df.head(<span class="dv">5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Survived</th>
<th data-quarto-table-cell-role="th">Pclass</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Sex</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">SibSp</th>
<th data-quarto-table-cell-role="th">Parch</th>
<th data-quarto-table-cell-role="th">Ticket</th>
<th data-quarto-table-cell-role="th">Fare</th>
<th data-quarto-table-cell-role="th">Cabin</th>
<th data-quarto-table-cell-role="th">Embarked</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">PassengerId</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">1</th>
<td>0</td>
<td>3</td>
<td>Braund, Mr. Owen Harris</td>
<td>male</td>
<td>22.0</td>
<td>1</td>
<td>0</td>
<td>A/5 21171</td>
<td>7.2500</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2</th>
<td>1</td>
<td>1</td>
<td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
<td>female</td>
<td>38.0</td>
<td>1</td>
<td>0</td>
<td>PC 17599</td>
<td>71.2833</td>
<td>C85</td>
<td>C</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">3</th>
<td>1</td>
<td>3</td>
<td>Heikkinen, Miss. Laina</td>
<td>female</td>
<td>26.0</td>
<td>0</td>
<td>0</td>
<td>STON/O2. 3101282</td>
<td>7.9250</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">4</th>
<td>1</td>
<td>1</td>
<td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
<td>female</td>
<td>35.0</td>
<td>1</td>
<td>0</td>
<td>113803</td>
<td>53.1000</td>
<td>C123</td>
<td>S</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">5</th>
<td>0</td>
<td>3</td>
<td>Allen, Mr. William Henry</td>
<td>male</td>
<td>35.0</td>
<td>0</td>
<td>0</td>
<td>373450</td>
<td>8.0500</td>
<td>NaN</td>
<td>S</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="data-exploration-and-cleaning-1" class="slide level2">
<h2>Data exploration and cleaning</h2>
<p>The passenger’s name and ticket number is probably not going to be particularly useful when predicting whether the passenger survived. Also these columns represent text data which is a bit harder to deal with. We’ll discuss how to do so in later chapters.</p>
<p>For now let’s disregard these variables.</p>
</section>
<section id="data-exploration-and-cleaning-2" class="slide level2">
<h2>Data exploration and cleaning</h2>
<p>Usually data is not perfect, for example:</p>
<ol type="1">
<li>There might duplicates, such as duplicated rows.</li>
<li>Some data points might be unknown or not exist, represented by null values in the data.</li>
<li>There might be outliers.</li>
<li>There might be illogical values due to data input errors.</li>
</ol>
<p>The general software engineering principle of “garbage in, garbage out” applies in data science as well, so next step is to identify these problems in our dataset and mitigate them.</p>
</section>
<section id="data-exploration-and-cleaning-3" class="slide level2">
<h2>Data exploration and cleaning</h2>
<p>To check for duplicates, let’s see if there are multiple rows for a person with same name. We can do this as follows:</p>
<div id="119e8ae5" class="cell" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href=""></a>df[df.duplicated([<span class="st">"Name"</span>])]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Survived</th>
<th data-quarto-table-cell-role="th">Pclass</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Sex</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">SibSp</th>
<th data-quarto-table-cell-role="th">Parch</th>
<th data-quarto-table-cell-role="th">Ticket</th>
<th data-quarto-table-cell-role="th">Fare</th>
<th data-quarto-table-cell-role="th">Cabin</th>
<th data-quarto-table-cell-role="th">Embarked</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">PassengerId</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="data-exploration-and-cleaning-4" class="slide level2">
<h2>Data exploration and cleaning</h2>
<p>There are no duplicates in this dataset. Let’s check for null values.</p>
<div id="4e2024ba" class="cell" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href=""></a>df.isnull().<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">0</span>)<span class="op">/</span><span class="bu">len</span>(df) <span class="co"># len(df) return the number of rows in a dataframe</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>Survived    0.000000
Pclass      0.000000
Name        0.000000
Sex         0.000000
Age         0.198653
SibSp       0.000000
Parch       0.000000
Ticket      0.000000
Fare        0.000000
Cabin       0.771044
Embarked    0.002245
dtype: float64</code></pre>
</div>
</div>
</section>
<section id="data-exploration-and-cleaning-5" class="slide level2">
<h2>Data exploration and cleaning</h2>
<p>77% of values in <code>Cabin</code> column are null. Since the vast majority of values in this column are null it will probably not be very useful to us. Especially since we have the passenger class in another column.</p>
<p>Let’s drop this column from our dataset as well.</p>
<p>We’ll discuss how to handle the nulls in the columns <code>Age</code> and <code>Embarked</code> a bit later.</p>
<div id="60e61a14" class="cell" data-execution_count="5">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href=""></a>df <span class="op">=</span> df.drop([<span class="st">"Cabin"</span>], axis<span class="op">=</span><span class="dv">1</span>) <span class="co"># axis=0 drops rows, axis=1 drops columns, default is axis=0</span></span>
<span id="cb6-2"><a href=""></a>df.head(<span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Survived</th>
<th data-quarto-table-cell-role="th">Pclass</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Sex</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">SibSp</th>
<th data-quarto-table-cell-role="th">Parch</th>
<th data-quarto-table-cell-role="th">Ticket</th>
<th data-quarto-table-cell-role="th">Fare</th>
<th data-quarto-table-cell-role="th">Embarked</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">PassengerId</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">1</th>
<td>0</td>
<td>3</td>
<td>Braund, Mr. Owen Harris</td>
<td>male</td>
<td>22.0</td>
<td>1</td>
<td>0</td>
<td>A/5 21171</td>
<td>7.2500</td>
<td>S</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2</th>
<td>1</td>
<td>1</td>
<td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
<td>female</td>
<td>38.0</td>
<td>1</td>
<td>0</td>
<td>PC 17599</td>
<td>71.2833</td>
<td>C</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">3</th>
<td>1</td>
<td>3</td>
<td>Heikkinen, Miss. Laina</td>
<td>female</td>
<td>26.0</td>
<td>0</td>
<td>0</td>
<td>STON/O2. 3101282</td>
<td>7.9250</td>
<td>S</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="data-exploration-and-cleaning-6" class="slide level2">
<h2>Data exploration and cleaning</h2>
<p>To scan for outliers / illogical values there is a useful dataframe method <code>describe</code>. It shows the descriptive statistics of the columns.</p>
<div id="910e829f" class="cell" data-execution_count="6">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href=""></a>df.describe()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Survived</th>
<th data-quarto-table-cell-role="th">Pclass</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">SibSp</th>
<th data-quarto-table-cell-role="th">Parch</th>
<th data-quarto-table-cell-role="th">Fare</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">count</th>
<td>891.000000</td>
<td>891.000000</td>
<td>714.000000</td>
<td>891.000000</td>
<td>891.000000</td>
<td>891.000000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">mean</th>
<td>0.383838</td>
<td>2.308642</td>
<td>29.699118</td>
<td>0.523008</td>
<td>0.381594</td>
<td>32.204208</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">std</th>
<td>0.486592</td>
<td>0.836071</td>
<td>14.526497</td>
<td>1.102743</td>
<td>0.806057</td>
<td>49.693429</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">min</th>
<td>0.000000</td>
<td>1.000000</td>
<td>0.420000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">25%</th>
<td>0.000000</td>
<td>2.000000</td>
<td>20.125000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>7.910400</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">50%</th>
<td>0.000000</td>
<td>3.000000</td>
<td>28.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>14.454200</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">75%</th>
<td>1.000000</td>
<td>3.000000</td>
<td>38.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>31.000000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">max</th>
<td>1.000000</td>
<td>3.000000</td>
<td>80.000000</td>
<td>8.000000</td>
<td>6.000000</td>
<td>512.329200</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="data-exploration-and-cleaning-7" class="slide level2">
<h2>Data exploration and cleaning</h2>
<p>All columns except <code>Fare</code> seem to be fine. Let’s plot a histogram of this column</p>
<div id="97791c4f" class="cell" data-execution_count="7">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href=""></a>df[<span class="st">"Fare"</span>].hist(bins<span class="op">=</span><span class="dv">20</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>

</div>
<img data-src="02_supervised_learning_files/figure-revealjs/cell-8-output-1.png" class="r-stretch"></section>
<section id="data-exploration-and-cleaning-8" class="slide level2">
<h2>Data exploration and cleaning</h2>
<p>There are several possible ways to deal with outlier values, for example:</p>
<ol type="1">
<li>Drop them from the dataset.</li>
<li>Cap the values.</li>
<li>Replace outlier values with the mean / median.</li>
</ol>
</section>
<section id="data-exploration-and-cleaning-9" class="slide level2">
<h2>Data exploration and cleaning</h2>
<p>In our case let’s create a column that represent the <code>Fare</code> with outlier values capped.</p>
<div id="5d89e757" class="cell" data-execution_count="8">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href=""></a>cap <span class="op">=</span> df[<span class="st">"Fare"</span>].quantile(<span class="fl">0.95</span>)</span>
<span id="cb9-2"><a href=""></a><span class="bu">print</span>(<span class="ss">f"95th percentile of 'Fare': </span><span class="sc">{</span>cap<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb9-3"><a href=""></a>df[<span class="st">"FareCapped"</span>] <span class="op">=</span> df[<span class="st">"Fare"</span>].clip(upper<span class="op">=</span>cap)</span>
<span id="cb9-4"><a href=""></a>df.describe()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>95th percentile of 'Fare': 112.07915</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Survived</th>
<th data-quarto-table-cell-role="th">Pclass</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">SibSp</th>
<th data-quarto-table-cell-role="th">Parch</th>
<th data-quarto-table-cell-role="th">Fare</th>
<th data-quarto-table-cell-role="th">FareCapped</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">count</th>
<td>891.000000</td>
<td>891.000000</td>
<td>714.000000</td>
<td>891.000000</td>
<td>891.000000</td>
<td>891.000000</td>
<td>891.000000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">mean</th>
<td>0.383838</td>
<td>2.308642</td>
<td>29.699118</td>
<td>0.523008</td>
<td>0.381594</td>
<td>32.204208</td>
<td>27.720486</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">std</th>
<td>0.486592</td>
<td>0.836071</td>
<td>14.526497</td>
<td>1.102743</td>
<td>0.806057</td>
<td>49.693429</td>
<td>29.225083</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">min</th>
<td>0.000000</td>
<td>1.000000</td>
<td>0.420000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">25%</th>
<td>0.000000</td>
<td>2.000000</td>
<td>20.125000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>7.910400</td>
<td>7.910400</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">50%</th>
<td>0.000000</td>
<td>3.000000</td>
<td>28.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>14.454200</td>
<td>14.454200</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">75%</th>
<td>1.000000</td>
<td>3.000000</td>
<td>38.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>31.000000</td>
<td>31.000000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">max</th>
<td>1.000000</td>
<td>3.000000</td>
<td>80.000000</td>
<td>8.000000</td>
<td>6.000000</td>
<td>512.329200</td>
<td>112.079150</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="feature-engineering" class="slide level2">
<h2>Feature engineering</h2>
<p>The inputs that go into a model are called model <strong>features</strong>.</p>
<p><strong>Feature engineering</strong> is a process where you take features that you already have and try to combine them to get new ones.</p>
<p>For example, if your dataset had features <code>UnitPrice</code> and <code>UnitCost</code> you could define a feature <span class="math display">\[ProfitMargin = \frac{UnitPrice-UnitCost}{UnitPrice}.\]</span></p>
</section>
<section id="feature-engineering-1" class="slide level2">
<h2>Feature engineering</h2>
<p>When using simple models (like we’ll do today) a lot of performance gains can be achieved through feature engineering.</p>
<p>Looking at our potential features one obvious thing to do is to sum up <code>SibSp</code> and <code>Parch</code> to get the total number of relatives on board.</p>
<div id="96b59873" class="cell" data-execution_count="9">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href=""></a>df[<span class="st">"NRelative"</span>] <span class="op">=</span> df[<span class="st">"SibSp"</span>] <span class="op">+</span> df[<span class="st">"Parch"</span>]</span>
<span id="cb11-2"><a href=""></a>df[[<span class="st">"Name"</span>, <span class="st">"NRelative"</span>]].head(<span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">NRelative</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">PassengerId</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">1</th>
<td>Braund, Mr. Owen Harris</td>
<td>1</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2</th>
<td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
<td>1</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">3</th>
<td>Heikkinen, Miss. Laina</td>
<td>0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="logistic-regression" class="slide level2">
<h2>Logistic Regression</h2>
<p>We’ll use one of the simplest possible models called <strong>logistic regression</strong>.</p>
<p>If the input is given by the variable <span class="math inline">\(x_1, x_2, \dots x_n\)</span> then the output of logistic regression is given by the formula</p>
<p><span class="math display">\[
  y = \sigma(w_0 + w_1 x_1 + w_2 x_2 + \dots + w_n x_n),
\]</span> where <span class="math inline">\(\sigma: \mathbb{R} \rightarrow (0, 1)\)</span> is the logistic function (also called the sigmoid function), given by <span class="math display">\[
\sigma(t) = \frac{1}{1+e^{-t}}.
\]</span></p>
</section>
<section id="logistic-regression-1" class="slide level2">
<h2>Logistic Regression</h2>
<p>Here is the graph of <span class="math inline">\(\sigma\)</span>:</p>

<img data-src="../images/logisticFunction.svg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="logistic-regression-2" class="slide level2">
<h2>Logistic Regression</h2>
<p>Logistic regression is classified as a linear model because after a change of variables the output depends on the input linearly.</p>
<p>The output of this model is a number in the interval <span class="math inline">\((0 ,1)\)</span>. This is usually interpreted as the predicted probability or <strong>confidence</strong> that the modelled event will occur given the inputs.</p>
<p>If the confidence is higher than <span class="math inline">\(0.5\)</span> we will predict that the passenger survived, if it is less than <span class="math inline">\(0.5\)</span> we will predict that they did not.</p>
</section>
<section id="logistic-regression-3" class="slide level2">
<h2>Logistic Regression</h2>
<p>The <span class="math inline">\(w\)</span>’s are parameters of the model.</p>
<p><span class="math inline">\(w_1, w_2, \dots, w_n\)</span> are usually called weights, while <span class="math inline">\(w_0\)</span> is called bias or intercept.</p>
<p>The goal is to pick the weights and bias in such a way that we get good predictions. This process is called model <strong>training</strong> or fitting.</p>
</section>
<section id="logistic-regression-4" class="slide level2">
<h2>Logistic Regression</h2>
<p>Logistic regression is trained as follows.</p>
<p>Suppose the vectors <span class="math inline">\((y_i, x_i),\)</span> <span class="math inline">\(i=1, \dots, m\)</span> represent our training data, where <span class="math inline">\(x_i = (x_{i1}, \dots, x_{in})\)</span> is a vector. Define functions <span class="math display">\[
  p(x; w_0, w) = \sigma(w_0 + \langle w, x \rangle),
\]</span> where <span class="math inline">\(w = (w_1, \dots, w_n)\)</span> is the vector of weights, and <span class="math inline">\(\langle w, x \rangle = w_1x_1 + \dots + w_nx_n\)</span> is the usual inner product, and</p>
</section>
<section id="logistic-regression-5" class="slide level2">
<h2>Logistic Regression</h2>
<p><span class="math display">\[\begin{equation*}
\begin{split}
&amp;L(w_0, w) = \\
&amp;\frac{1}{n}\sum_{i=1}^n -y_i \log(p(x; w_0, w)) -(1-y_i)\log(1-p(x; w_0, w))
\end{split}
\end{equation*}\]</span></p>
<p>The function <span class="math inline">\(L\)</span> is called the <strong>loss function</strong> (sometimes also called cost function). While in this case it is a bit scary, the main idea is simple: the better our model fits the training data given the weights the smaller the value of <span class="math inline">\(L\)</span> will be.</p>
</section>
<section id="logistic-regression-6" class="slide level2">
<h2>Logistic Regression</h2>
<p>We can then train the model by minimizing the function <span class="math inline">\(L\)</span>. I.e. we need to run an algorithm which will find values of <span class="math inline">\(w_0, w_1, \dots, w_n\)</span> such that <span class="math inline">\(L\)</span> would be as small as possible.</p>
<p>We will discuss optimization algorithms in a later chapter. For now we’ll rely on <code>sklearn's</code> training procedure.</p>
<p>When training models we need to split our dataset into train and test sets. This is because we will want to evaluate how our model performs on data that it has not seen during training.</p>
</section>
<section id="logistic-regression-7" class="slide level2">
<h2>Logistic Regression</h2>
<p>Here is how to perform the train test split using <code>sklearn</code>:</p>
<div id="51c31641" class="cell" data-execution_count="10">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href=""></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb12-2"><a href=""></a></span>
<span id="cb12-3"><a href=""></a>X, y <span class="op">=</span> df[[<span class="st">"Pclass"</span>, <span class="st">"Sex"</span>, <span class="st">"Age"</span>, <span class="st">"SibSp"</span>, <span class="st">"Parch"</span>, <span class="st">"Embarked"</span>, <span class="st">"FareCapped"</span>, <span class="st">"NRelative"</span>]], df[<span class="st">"Survived"</span>]</span>
<span id="cb12-4"><a href=""></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">34</span>) <span class="co"># We are leaving 20% of the data for testing, since train_test_split samples the data randomly providing random_state ensures that the output of this function will always be the same every time you run it</span></span>
<span id="cb12-5"><a href=""></a>X_train.head(<span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Pclass</th>
<th data-quarto-table-cell-role="th">Sex</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">SibSp</th>
<th data-quarto-table-cell-role="th">Parch</th>
<th data-quarto-table-cell-role="th">Embarked</th>
<th data-quarto-table-cell-role="th">FareCapped</th>
<th data-quarto-table-cell-role="th">NRelative</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">PassengerId</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">674</th>
<td>2</td>
<td>male</td>
<td>31.0</td>
<td>0</td>
<td>0</td>
<td>S</td>
<td>13.0000</td>
<td>0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">256</th>
<td>3</td>
<td>female</td>
<td>29.0</td>
<td>0</td>
<td>2</td>
<td>C</td>
<td>15.2458</td>
<td>2</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">867</th>
<td>2</td>
<td>female</td>
<td>27.0</td>
<td>1</td>
<td>0</td>
<td>C</td>
<td>13.8583</td>
<td>1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="categorical-data" class="slide level2">
<h2>Categorical data</h2>
<p>Let’s get back to our problem. As you might have noticed we now have two types of features in our dataset:</p>
<ol type="1">
<li>Categorical - where the feature takes a finite number of values (ex. sex, passenger class).</li>
<li>Numerical - where the feature is some real variable (ex. fare, age).</li>
</ol>
<p>Categorical features might be represented by non-numerical data (ex. sex) so we cannot just plug them into logistic regression as we need the input to be a real number. Let’s discuss how to overcome this problem.</p>
</section>
<section id="categorical-data-1" class="slide level2">
<h2>Categorical Data</h2>
<p>Categorical data is usually represented in a model through <strong>one hot encoding</strong>.</p>
<p>In one hot encoded data a categorical variable is represented by vector of length <span class="math inline">\(k,\)</span> where <span class="math inline">\(k\)</span> is the number of classes. The vector has all entries equal to <span class="math inline">\(0\)</span> except one where it has the value <span class="math inline">\(1.\)</span> I.e. the class gets encoded using the position of the vector. Null values are usually treated as a separate class.</p>
</section>
<section id="categorical-data-2" class="slide level2">
<h2>Categorical Data</h2>
<p>For example, one possible one hot encoding of the feature <code>Embarked</code> is:</p>
<ul>
<li><code>S</code>: (1, 0, 0, 0)</li>
<li><code>C</code>: (0, 1, 0, 0)</li>
<li><code>Q</code>: (0, 0, 1, 0)</li>
<li><code>null</code>: (0, 0, 0, 1)</li>
</ul>
<p>Note that even when the categories are represented by numbers (ex. passenger class) it is still a good idea to use one hot encoding because it removes the implicit and usually wrong ordinal relationship of the variable.</p>
</section>
<section id="categorical-data-3" class="slide level2">
<h2>Categorical Data</h2>
<p>Here is how to do one hot encoding using <code>sklearn</code>:</p>
<div id="f9d49a1d" class="cell" data-execution_count="11">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href=""></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> OneHotEncoder</span>
<span id="cb13-2"><a href=""></a></span>
<span id="cb13-3"><a href=""></a>encoder <span class="op">=</span> OneHotEncoder(handle_unknown<span class="op">=</span><span class="st">'ignore'</span>) <span class="co"># handle_unknown specifies what to do with categories that are not seen during training</span></span>
<span id="cb13-4"><a href=""></a>one_hot_encoded <span class="op">=</span> encoder.fit_transform(X_train[[<span class="st">"Embarked"</span>]])</span>
<span id="cb13-5"><a href=""></a>one_hot_encoded.toarray()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>array([[0., 0., 1., 0.],
       [1., 0., 0., 0.],
       [1., 0., 0., 0.],
       ...,
       [0., 0., 1., 0.],
       [1., 0., 0., 0.],
       [0., 0., 1., 0.]], shape=(712, 4))</code></pre>
</div>
</div>
</section>
<section id="numerical-data" class="slide level2">
<h2>Numerical Data</h2>
<p>It is also a good idea to preprocess features representing numerical data.</p>
<p>We are going to handle the nulls by replacing them with a median value of the feature.</p>
</section>
<section id="numerical-data-1" class="slide level2">
<h2>Numerical Data</h2>
<p>We are also going to standardize numerical features by first subtracting the mean of the feature from each entry and then dividing the result by the standard deviation of the feature. This is going to leave us with a feature whose mean is 0 and standard deviation is 1.</p>
<p>While this is not strictly necessary, it is a good idea to do because it allows the model to learn faster (and thus better). Standard scaling becomes a hard requirement when models become more complicated and take much longer time to train.</p>
</section>
<section id="numerical-data-2" class="slide level2">
<h2>Numerical Data</h2>
<p>Here is how to do this preprocessing in <code>sklearn</code>:</p>
<div id="9be6bd62" class="cell" data-execution_count="12">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href=""></a><span class="im">from</span> sklearn.impute <span class="im">import</span> SimpleImputer</span>
<span id="cb15-2"><a href=""></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb15-3"><a href=""></a></span>
<span id="cb15-4"><a href=""></a>imputer <span class="op">=</span> SimpleImputer(strategy<span class="op">=</span><span class="st">"median"</span>) <span class="co"># strategy specifies how to handle null values</span></span>
<span id="cb15-5"><a href=""></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb15-6"><a href=""></a></span>
<span id="cb15-7"><a href=""></a>inp <span class="op">=</span> imputer.fit_transform(X_train[[<span class="st">"Age"</span>]])</span>
<span id="cb15-8"><a href=""></a>scaled <span class="op">=</span> scaler.fit_transform(inp)</span>
<span id="cb15-9"><a href=""></a>scaled[<span class="dv">0</span>:<span class="dv">3</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>array([[ 0.11590575],
       [-0.03564399],
       [-0.18719373]])</code></pre>
</div>
</div>
</section>
<section id="creating-the-model" class="slide level2">
<h2>Creating the model</h2>
<p>Handling all the preprocessing steps separately can lead to messy code. <code>sklearn</code> provides <a href="https://scikit-learn.org/stable/modules/compose.html#combining-estimators">pipelines</a> to package all the model steps into a single object.</p>
<p>Let’s see how to use them.</p>
</section>
<section id="creating-the-model-1" class="slide level2">
<h2>Creating the model</h2>
<div id="02441b9d" class="cell" data-execution_count="13">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href=""></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> Pipeline</span>
<span id="cb17-2"><a href=""></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb17-3"><a href=""></a><span class="im">from</span> sklearn.impute <span class="im">import</span> SimpleImputer</span>
<span id="cb17-4"><a href=""></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb17-5"><a href=""></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> OneHotEncoder</span>
<span id="cb17-6"><a href=""></a><span class="im">from</span> sklearn.compose <span class="im">import</span> ColumnTransformer</span>
<span id="cb17-7"><a href=""></a></span>
<span id="cb17-8"><a href=""></a><span class="kw">def</span> make_pipeline(</span>
<span id="cb17-9"><a href=""></a>  numerical_features,</span>
<span id="cb17-10"><a href=""></a>  categorical_features,</span>
<span id="cb17-11"><a href=""></a>  model</span>
<span id="cb17-12"><a href=""></a>):</span>
<span id="cb17-13"><a href=""></a>  transformers <span class="op">=</span> [] <span class="co"># This list will contain all the preprocessing steps</span></span>
<span id="cb17-14"><a href=""></a></span>
<span id="cb17-15"><a href=""></a>  <span class="cf">if</span> <span class="bu">len</span>(numerical_features) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb17-16"><a href=""></a>    numerical_steps <span class="op">=</span> [</span>
<span id="cb17-17"><a href=""></a>      (<span class="st">"imputer"</span>, SimpleImputer(strategy<span class="op">=</span><span class="st">"median"</span>)),</span>
<span id="cb17-18"><a href=""></a>      (<span class="st">"scaler"</span>, StandardScaler())</span>
<span id="cb17-19"><a href=""></a>    ]</span>
<span id="cb17-20"><a href=""></a>    transformers.append(</span>
<span id="cb17-21"><a href=""></a>      (<span class="st">"numerical"</span>, Pipeline(steps<span class="op">=</span>numerical_steps), numerical_features.copy())</span>
<span id="cb17-22"><a href=""></a>    )</span>
<span id="cb17-23"><a href=""></a></span>
<span id="cb17-24"><a href=""></a>  <span class="cf">if</span> <span class="bu">len</span>(categorical_features) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb17-25"><a href=""></a>    categorical_steps <span class="op">=</span> [</span>
<span id="cb17-26"><a href=""></a>      (<span class="st">"encoder"</span>, OneHotEncoder(handle_unknown<span class="op">=</span><span class="st">"ignore"</span>))</span>
<span id="cb17-27"><a href=""></a>    ]</span>
<span id="cb17-28"><a href=""></a>    transformers.append(</span>
<span id="cb17-29"><a href=""></a>      (<span class="st">"categorical"</span>, Pipeline(steps<span class="op">=</span>categorical_steps), categorical_features.copy())</span>
<span id="cb17-30"><a href=""></a>    )</span>
<span id="cb17-31"><a href=""></a></span>
<span id="cb17-32"><a href=""></a>  preprocessor <span class="op">=</span> ColumnTransformer(transformers<span class="op">=</span>transformers) <span class="co"># Compose the two transformers</span></span>
<span id="cb17-33"><a href=""></a></span>
<span id="cb17-34"><a href=""></a>  pipeline <span class="op">=</span> Pipeline(</span>
<span id="cb17-35"><a href=""></a>    steps<span class="op">=</span>[</span>
<span id="cb17-36"><a href=""></a>      (<span class="st">"preprocessor"</span>, preprocessor),</span>
<span id="cb17-37"><a href=""></a>      (<span class="st">"model"</span>, model),</span>
<span id="cb17-38"><a href=""></a>    ],</span>
<span id="cb17-39"><a href=""></a>  )</span>
<span id="cb17-40"><a href=""></a></span>
<span id="cb17-41"><a href=""></a>  <span class="cf">return</span> pipeline</span>
<span id="cb17-42"><a href=""></a></span>
<span id="cb17-43"><a href=""></a>model <span class="op">=</span> LogisticRegression(random_state<span class="op">=</span><span class="dv">34</span>)</span>
<span id="cb17-44"><a href=""></a></span>
<span id="cb17-45"><a href=""></a>pipeline <span class="op">=</span> make_pipeline(</span>
<span id="cb17-46"><a href=""></a>  numerical_features<span class="op">=</span>[<span class="st">"Age"</span>, <span class="st">"SibSp"</span>, <span class="st">"Parch"</span>, <span class="st">"NRelative"</span>, <span class="st">"FareCapped"</span>],</span>
<span id="cb17-47"><a href=""></a>  categorical_features<span class="op">=</span>[<span class="st">"Pclass"</span>, <span class="st">"Sex"</span>, <span class="st">"Embarked"</span>],</span>
<span id="cb17-48"><a href=""></a>  model<span class="op">=</span>model</span>
<span id="cb17-49"><a href=""></a>)</span>
<span id="cb17-50"><a href=""></a>pipeline</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>

</section>
<section id="creating-the-model-1-output" class="slide level2 output-location-slide"><h2>Creating the model</h2><div class="cell output-location-slide" data-execution_count="13">
<div class="cell-output cell-output-display" data-execution_count="13">
<style>#sk-container-id-1 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: #000;
  --sklearn-color-text-muted: #666;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-1 {
  color: var(--sklearn-color-text);
}

#sk-container-id-1 pre {
  padding: 0;
}

#sk-container-id-1 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-1 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-1 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-1 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-1 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-1 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-1 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-1 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-1 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-1 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-1 label.sk-toggleable__label {
  cursor: pointer;
  display: flex;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
  align-items: start;
  justify-content: space-between;
  gap: 0.5em;
}

#sk-container-id-1 label.sk-toggleable__label .caption {
  font-size: 0.6rem;
  font-weight: lighter;
  color: var(--sklearn-color-text-muted);
}

#sk-container-id-1 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-1 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-1 div.sk-label label.sk-toggleable__label,
#sk-container-id-1 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-1 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-1 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-1 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-1 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-1 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 0.5em;
  text-align: center;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-1 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-1 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-1 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-1 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Pipeline(steps=[('preprocessor',
                 ColumnTransformer(transformers=[('numerical',
                                                  Pipeline(steps=[('imputer',
                                                                   SimpleImputer(strategy='median')),
                                                                  ('scaler',
                                                                   StandardScaler())]),
                                                  ['Age', 'SibSp', 'Parch',
                                                   'NRelative', 'FareCapped']),
                                                 ('categorical',
                                                  Pipeline(steps=[('encoder',
                                                                   OneHotEncoder(handle_unknown='ignore'))]),
                                                  ['Pclass', 'Sex',
                                                   'Embarked'])])),
                ('model', LogisticRegression(random_state=34))])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label  sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox"><label for="sk-estimator-id-1" class="sk-toggleable__label  sk-toggleable__label-arrow"><div><div>Pipeline</div></div><div><a class="sk-estimator-doc-link " rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.6/modules/generated/sklearn.pipeline.Pipeline.html">?<span>Documentation for Pipeline</span></a><span class="sk-estimator-doc-link ">i<span>Not fitted</span></span></div></label><div class="sk-toggleable__content "><pre>Pipeline(steps=[('preprocessor',
                 ColumnTransformer(transformers=[('numerical',
                                                  Pipeline(steps=[('imputer',
                                                                   SimpleImputer(strategy='median')),
                                                                  ('scaler',
                                                                   StandardScaler())]),
                                                  ['Age', 'SibSp', 'Parch',
                                                   'NRelative', 'FareCapped']),
                                                 ('categorical',
                                                  Pipeline(steps=[('encoder',
                                                                   OneHotEncoder(handle_unknown='ignore'))]),
                                                  ['Pclass', 'Sex',
                                                   'Embarked'])])),
                ('model', LogisticRegression(random_state=34))])</pre></div> </div></div><div class="sk-serial"><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label  sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox"><label for="sk-estimator-id-2" class="sk-toggleable__label  sk-toggleable__label-arrow"><div><div>preprocessor: ColumnTransformer</div></div><div><a class="sk-estimator-doc-link " rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.6/modules/generated/sklearn.compose.ColumnTransformer.html">?<span>Documentation for preprocessor: ColumnTransformer</span></a></div></label><div class="sk-toggleable__content "><pre>ColumnTransformer(transformers=[('numerical',
                                 Pipeline(steps=[('imputer',
                                                  SimpleImputer(strategy='median')),
                                                 ('scaler', StandardScaler())]),
                                 ['Age', 'SibSp', 'Parch', 'NRelative',
                                  'FareCapped']),
                                ('categorical',
                                 Pipeline(steps=[('encoder',
                                                  OneHotEncoder(handle_unknown='ignore'))]),
                                 ['Pclass', 'Sex', 'Embarked'])])</pre></div> </div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label  sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-3" type="checkbox"><label for="sk-estimator-id-3" class="sk-toggleable__label  sk-toggleable__label-arrow"><div><div>numerical</div></div></label><div class="sk-toggleable__content "><pre>['Age', 'SibSp', 'Parch', 'NRelative', 'FareCapped']</pre></div> </div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator  sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-4" type="checkbox"><label for="sk-estimator-id-4" class="sk-toggleable__label  sk-toggleable__label-arrow"><div><div>SimpleImputer</div></div><div><a class="sk-estimator-doc-link " rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.6/modules/generated/sklearn.impute.SimpleImputer.html">?<span>Documentation for SimpleImputer</span></a></div></label><div class="sk-toggleable__content "><pre>SimpleImputer(strategy='median')</pre></div> </div></div><div class="sk-item"><div class="sk-estimator  sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-5" type="checkbox"><label for="sk-estimator-id-5" class="sk-toggleable__label  sk-toggleable__label-arrow"><div><div>StandardScaler</div></div><div><a class="sk-estimator-doc-link " rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.6/modules/generated/sklearn.preprocessing.StandardScaler.html">?<span>Documentation for StandardScaler</span></a></div></label><div class="sk-toggleable__content "><pre>StandardScaler()</pre></div> </div></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label  sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-6" type="checkbox"><label for="sk-estimator-id-6" class="sk-toggleable__label  sk-toggleable__label-arrow"><div><div>categorical</div></div></label><div class="sk-toggleable__content "><pre>['Pclass', 'Sex', 'Embarked']</pre></div> </div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator  sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-7" type="checkbox"><label for="sk-estimator-id-7" class="sk-toggleable__label  sk-toggleable__label-arrow"><div><div>OneHotEncoder</div></div><div><a class="sk-estimator-doc-link " rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.6/modules/generated/sklearn.preprocessing.OneHotEncoder.html">?<span>Documentation for OneHotEncoder</span></a></div></label><div class="sk-toggleable__content "><pre>OneHotEncoder(handle_unknown='ignore')</pre></div> </div></div></div></div></div></div></div></div></div><div class="sk-item"><div class="sk-estimator  sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-8" type="checkbox"><label for="sk-estimator-id-8" class="sk-toggleable__label  sk-toggleable__label-arrow"><div><div>LogisticRegression</div></div><div><a class="sk-estimator-doc-link " rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.6/modules/generated/sklearn.linear_model.LogisticRegression.html">?<span>Documentation for LogisticRegression</span></a></div></label><div class="sk-toggleable__content "><pre>LogisticRegression(random_state=34)</pre></div> </div></div></div></div></div></div>
</div>
</div></section><section id="creating-the-model-2" class="slide level2">
<h2>Creating the model</h2>
<p>We can now train and evaluate the model.</p>
<div id="8af7eea9" class="cell" data-execution_count="14">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href=""></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report</span>
<span id="cb18-2"><a href=""></a></span>
<span id="cb18-3"><a href=""></a>pipeline.fit(X_train, y_train) <span class="co"># Train the model on training data</span></span>
<span id="cb18-4"><a href=""></a>y_pred <span class="op">=</span> pipeline.predict(X_test) <span class="co"># Predict on test set</span></span>
<span id="cb18-5"><a href=""></a><span class="bu">print</span>(classification_report(y_test, y_pred))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>              precision    recall  f1-score   support

           0       0.87      0.91      0.89       118
           1       0.80      0.74      0.77        61

    accuracy                           0.85       179
   macro avg       0.84      0.82      0.83       179
weighted avg       0.85      0.85      0.85       179
</code></pre>
</div>
</div>
</section>
<section id="evaluating-the-model" class="slide level2">
<h2>Evaluating the model</h2>
<p>Let’s discuss what <strong>accuracy</strong>, <strong>precision</strong>, <strong>recall</strong> and <strong>f1-score</strong> are.</p>
<p>Accuracy is just the part of predictions that your model got right. We could have computed it as follows:</p>
<div id="154a5282" class="cell" data-execution_count="15">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href=""></a>(y_test <span class="op">==</span> y_pred).<span class="bu">sum</span>()<span class="op">/</span><span class="bu">len</span>(y_test)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>np.float64(0.8491620111731844)</code></pre>
</div>
</div>
</section>
<section id="evaluating-the-model-1" class="slide level2">
<h2>Evaluating the model</h2>
<p>Accuracy is sometimes not enough to evaluate a model.</p>
<p>For example, suppose you were building a model to predict whether a flood will happen tomorrow. Suppose floods in your location happen only on 0.5% of days.</p>
<p>Then a model could output that the flood won’t happen with no regard to the input provided and have an accuracy of 99.5%. Of course such a model is completely useless.</p>
</section>
<section id="evaluating-the-model-2" class="slide level2">
<h2>Evaluating the model</h2>
<p>Precision, recall and f1-score are defined for each class separately as follows:</p>
<ul>
<li>Precision: number of correct predictions of class A divided by the number of all predictions of class A</li>
<li>Recall: number of correct predictions of class A divided by the total number of samples in class A</li>
<li>F1-score: harmonic mean of precision and recall</li>
</ul>
</section>
<section id="evaluating-the-model-3" class="slide level2">
<h2>Evaluating the model</h2>
<p>For example, suppose we have the following dataset with predictions:</p>
<table class="caption-top">
<thead>
<tr class="header">
<th>correct label</th>
<th>cat</th>
<th>dog</th>
<th>cat</th>
<th>dog</th>
<th>dog</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>prediction</td>
<td>dog</td>
<td>cat</td>
<td>cat</td>
<td>cat</td>
<td>dog</td>
</tr>
</tbody>
</table>
<p>Then we have:</p>
<table class="caption-top">
<thead>
<tr class="header">
<th></th>
<th>precision</th>
<th>recall</th>
<th>f1-score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>cat</td>
<td>1/3</td>
<td>1/2</td>
<td>0.4</td>
</tr>
<tr class="even">
<td>dog</td>
<td>1/2</td>
<td>1/3</td>
<td>0.4</td>
</tr>
</tbody>
</table>
<p>Also accuracy is 2/5.</p>
</section>
<section id="evaluating-the-model-4" class="slide level2">
<h2>Evaluating the model</h2>
<p>We used the 0.5 confidence threshold to mark the passenger as surviving the sinking. We could have used some other value.</p>
<p>Higher confidence threshold leads to higher precision and lower recall. While a lower confidence threshold leads to a higher recall at a cost of lower precision.</p>
<p>What confidence threshold is appropriate depends on your modelling task, sometimes precision is more important while at other times recall is.</p>
</section>
<section id="evaluating-the-model-5" class="slide level2">
<h2>Evaluating the model</h2>
<p>To evaluate a model you can also use a confusion matrix. Here is how to generate a confusion matrix using sklearn.</p>
<div id="53cadfd6" class="cell" data-execution_count="16">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href=""></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> ConfusionMatrixDisplay</span>
<span id="cb22-2"><a href=""></a></span>
<span id="cb22-3"><a href=""></a>ConfusionMatrixDisplay.from_predictions(y_test, y_pred)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>

</div>
<img data-src="02_supervised_learning_files/figure-revealjs/cell-17-output-1.png" class="r-stretch"></section>
<section id="evaluating-the-model-6" class="slide level2">
<h2>Evaluating the model</h2>
<p>Confusion matrices quickly become unwieldy when there are more than two classes (in real world applications there can easily be 100+ classes). You can get the same insights from the precision and recall metrics that you would get from a confusion matrix.</p>
</section>
<section id="feature-importance" class="slide level2">
<h2>Feature Importance</h2>
<p>In logistic regression, the higher the absolute value of the weight of the feature the more important the feature is.</p>
<p>We can can check the importance of the features in our model as follows:</p>
<div id="9b7e4f02" class="cell" data-execution_count="17">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href=""></a>pd.DataFrame(pipeline[<span class="st">"model"</span>].coef_, columns<span class="op">=</span>pipeline[:<span class="op">-</span><span class="dv">1</span>].get_feature_names_out())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">numerical__Age</th>
<th data-quarto-table-cell-role="th">numerical__SibSp</th>
<th data-quarto-table-cell-role="th">numerical__Parch</th>
<th data-quarto-table-cell-role="th">numerical__NRelative</th>
<th data-quarto-table-cell-role="th">numerical__FareCapped</th>
<th data-quarto-table-cell-role="th">categorical__Pclass_1</th>
<th data-quarto-table-cell-role="th">categorical__Pclass_2</th>
<th data-quarto-table-cell-role="th">categorical__Pclass_3</th>
<th data-quarto-table-cell-role="th">categorical__Sex_female</th>
<th data-quarto-table-cell-role="th">categorical__Sex_male</th>
<th data-quarto-table-cell-role="th">categorical__Embarked_C</th>
<th data-quarto-table-cell-role="th">categorical__Embarked_Q</th>
<th data-quarto-table-cell-role="th">categorical__Embarked_S</th>
<th data-quarto-table-cell-role="th">categorical__Embarked_nan</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>-0.491155</td>
<td>-0.236806</td>
<td>-0.027614</td>
<td>-0.175873</td>
<td>0.233337</td>
<td>0.858517</td>
<td>0.154425</td>
<td>-0.943775</td>
<td>1.33036</td>
<td>-1.261193</td>
<td>0.098238</td>
<td>0.040869</td>
<td>-0.26607</td>
<td>0.19613</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="regularization" class="slide level2">
<h2>Regularization</h2>
<p>It happens that the model overfits the data it has seen during training. This means that the model learned the particular noise in the training data and it is then unable to generalize on the data it has not seen.</p>

<img data-src="../images/overfitting.svg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="regularization-1" class="slide level2">
<h2>Regularization</h2>
<p>We will discuss overfitting more in the next chapter.</p>
<p>Different model architectures have different strategies for mitigating overfitting. In logistic regression you can use regularization.</p>
</section>
<section id="regularization-2" class="slide level2">
<h2>Regularization</h2>
<p>The idea of regularization is that you add an extra penalty term to your loss function that penalizes large weights:</p>
<p><span class="math display">\[
    L_1(w) = L_0(w) + \frac{r(w)}{C},
\]</span> here <span class="math inline">\(L\)</span> is the original loss function defined above, <span class="math inline">\(r\)</span> is the penalty and <span class="math inline">\(C\)</span> is a fixed parameter controlling regularization strength.</p>
</section>
<section id="regularization-3" class="slide level2">
<h2>Regularization</h2>
<p>Typical choices for <span class="math inline">\(r\)</span> are:</p>
<ul>
<li><span class="math inline">\(l_1\)</span>: <span class="math inline">\(r(w) = \frac{1}{n}\sum_{i=0}^n |w_i|\)</span></li>
<li><span class="math inline">\(l_2\)</span>: <span class="math inline">\(r(w) = \frac{1}{n}\sum_{i=0}^n w_i^2\)</span></li>
<li>A linear combination of the above.</li>
</ul>
<p><code>sklearn</code> by default adds a <span class="math inline">\(l_2\)</span> regularization term.</p>
</section>
<section id="practice-task" class="slide level2">
<h2>Practice task</h2>
<p>For practice, you could try building a logistic regression model for the <code>Iris dataset</code>. This dataset ships with <code>sklearn</code>. The goal is to predict the type of plant given some measurements.</p>
<p>Here is how to load the dataset:</p>
<div id="d5c01ffa" class="cell" data-execution_count="18">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href=""></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> load_iris</span>
<span id="cb24-2"><a href=""></a></span>
<span id="cb24-3"><a href=""></a>data <span class="op">=</span> load_iris()</span>
<span id="cb24-4"><a href=""></a>df <span class="op">=</span> pd.DataFrame(data[<span class="st">"data"</span>], columns<span class="op">=</span>data[<span class="st">"feature_names"</span>])</span>
<span id="cb24-5"><a href=""></a>df[<span class="st">"target"</span>] <span class="op">=</span> data[<span class="st">"target_names"</span>][data[<span class="st">"target"</span>]]</span>
<span id="cb24-6"><a href=""></a>df.head(<span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">sepal length (cm)</th>
<th data-quarto-table-cell-role="th">sepal width (cm)</th>
<th data-quarto-table-cell-role="th">petal length (cm)</th>
<th data-quarto-table-cell-role="th">petal width (cm)</th>
<th data-quarto-table-cell-role="th">target</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>5.1</td>
<td>3.5</td>
<td>1.4</td>
<td>0.2</td>
<td>setosa</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>4.9</td>
<td>3.0</td>
<td>1.4</td>
<td>0.2</td>
<td>setosa</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>4.7</td>
<td>3.2</td>
<td>1.3</td>
<td>0.2</td>
<td>setosa</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="practice-task-1" class="slide level2">
<h2>Practice task</h2>
<p>This is a very simple dataset so it should not be difficult to get good results. Afterwards, try improving the model for the Titanic dataset. You can find it <a href="https://github.com/jputrius/ml_intro/tree/main/data/titanic">here</a>.</p>

</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="02_supervised_learning_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="02_supervised_learning_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="02_supervised_learning_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="02_supervised_learning_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="02_supervised_learning_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="02_supervised_learning_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="02_supervised_learning_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="02_supervised_learning_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="02_supervised_learning_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="02_supervised_learning_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
          const outerScaffold = trigger.parentElement.cloneNode(true);
          const codeEl = outerScaffold.querySelector('code');
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>