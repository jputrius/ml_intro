<!DOCTYPE html>
<html lang="en"><head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="01_applications_of_linear_algebra_files/libs/clipboard/clipboard.min.js"></script>
<script src="01_applications_of_linear_algebra_files/libs/quarto-html/tabby.min.js"></script>
<script src="01_applications_of_linear_algebra_files/libs/quarto-html/popper.min.js"></script>
<script src="01_applications_of_linear_algebra_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="01_applications_of_linear_algebra_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="01_applications_of_linear_algebra_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="01_applications_of_linear_algebra_files/libs/quarto-html/quarto-syntax-highlighting-d4d76bf8491c20bad77d141916dc28e1.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.43">

  <title>Chapter 1: Applications of Linear Algebra</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="01_applications_of_linear_algebra_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="01_applications_of_linear_algebra_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="01_applications_of_linear_algebra_files/libs/revealjs/dist/theme/quarto-b939305c81d88731513e5363f425024f.css">
  <link href="01_applications_of_linear_algebra_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="01_applications_of_linear_algebra_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="01_applications_of_linear_algebra_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="01_applications_of_linear_algebra_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
  
  <script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Chapter 1: Applications of Linear Algebra</h1>

<div class="quarto-title-authors">
</div>

</section>
<section id="introduction" class="slide level2">
<h2>Introduction</h2>
<p>In this introductory chapter we will look at some applications of linear algebra to data science problems.</p>
<p>In fact we will only need real matrices. As a reminder, a real matrix <span class="math inline">\(A\)</span> is a table with <span class="math inline">\(n\)</span> rows and <span class="math inline">\(m\)</span> columns, entries of which are real numbers <span class="math inline">\(a_{ij},\)</span> <span class="math inline">\(1 \le i \le n,\)</span> <span class="math inline">\(1 \le j \le m.\)</span> The following notation is used <span class="math inline">\(A=(a_{ij}).\)</span> Here are some examples of matrices:</p>
<p><span class="math display">\[
\begin{pmatrix}
1 &amp; 2\\
3 &amp; 4
\end{pmatrix}, \
\begin{pmatrix}
5 &amp; 6 &amp; 7 \\
8 &amp; 9 &amp; 10
\end{pmatrix}, \
\begin{pmatrix}
\sqrt{2} \\
\pi \\
e
\end{pmatrix}.
\]</span></p>
</section>
<section id="review-matrix-operations" class="slide level2">
<h2>Review: Matrix operations</h2>
<p>If you do not remember / are not familiar with standard algebraic operations on matrices please read through <a href="https://en.wikipedia.org/wiki/Matrix_(mathematics)#Basic_operations">this wikipedia article</a>.</p>
<p>We will denote the transpose of the matrix <span class="math inline">\(A\)</span> by <span class="math inline">\(A^T\)</span>, i.e.&nbsp;<span class="math inline">\(A^T\)</span> is <span class="math inline">\(A\)</span> with rows and columns switched. Example: <span class="math display">\[
  A = \begin{pmatrix}
1 &amp; 2\\
3 &amp; 4
\end{pmatrix}, \ A^T = \begin{pmatrix}
1 &amp; 3\\
2 &amp; 4
\end{pmatrix}
\]</span></p>
</section>
<section id="review-matrix-determinant" class="slide level2">
<h2>Review: Matrix Determinant</h2>
<p>If you do not remember / are not familiar with the matrix determinant please read through <a href="https://en.wikipedia.org/wiki/Determinant">this wikipedia article</a>.</p>
<p>We will denote the determinant of <span class="math inline">\(A\)</span> by <span class="math inline">\(\det(A).\)</span> Example: <span class="math display">\[
  \det \begin{pmatrix}
a &amp; b\\
c &amp; d
\end{pmatrix} = \begin{vmatrix}
a &amp; b\\
c &amp; d
\end{vmatrix} = ad-bc.
\]</span></p>
</section>
<section id="review-eigenvalues" class="slide level2">
<h2>Review: Eigenvalues</h2>
<p>A matrix is called square if it has the same number of rows and columns.</p>
<p>A complex number <span class="math inline">\(\lambda\)</span> is called an <strong>eigenvalue</strong> of an <span class="math inline">\(n\)</span> by <span class="math inline">\(n\)</span> square matrix <span class="math inline">\(A\)</span> if there exists an <span class="math inline">\(n\)</span> dimensional non-zero column vector <span class="math inline">\(u \in \mathbb{R}\)</span> such that <span class="math display">\[
  Au = \lambda u.
\]</span></p>
<p>The vector <span class="math inline">\(u\)</span> is then called an <strong>eigenvector</strong>. Eigenvectors corresponding to the same eigenvalue form a linear subspace of <span class="math inline">\(\mathbb{R}^n.\)</span></p>
</section>
<section id="review-finding-eigenvalues-i" class="slide level2">
<h2>Review: Finding Eigenvalues I</h2>
<p>Eigenvalues of <span class="math inline">\(A\)</span> are in one to one correspondence with the roots of the polynomial <span class="math display">\[
  P(\lambda) = \det(A-\lambda I),
\]</span> where <span class="math inline">\(I\)</span> is the identity matrix.</p>
</section>
<section id="review-finding-eigenvalues-ii" class="slide level2">
<h2>Review: Finding Eigenvalues II</h2>
<p>For example, in order to find the eigenvalues of <span class="math display">\[
\begin{pmatrix}
1 &amp; 2\\
3 &amp; 4
\end{pmatrix}
\]</span> we can solve the following equation <span class="math display">\[
\det \begin{pmatrix}
1-\lambda &amp; 2\\
3 &amp; 4-\lambda
\end{pmatrix} = \lambda^2-5\lambda-2=0.
\]</span> Solutions are <span class="math inline">\(\frac{5+\sqrt{33}}{2}\approx5.37,\)</span> <span class="math inline">\(\frac{5-\sqrt{33}}{2}\approx-0.37\)</span>.</p>
</section>
<section id="review-finding-eigenvalues-iii" class="slide level2">
<h2>Review: Finding Eigenvalues III</h2>
<p>We can also find eigenvalues of a matrix using python’s <code>numpy</code> package:</p>
<div id="46ff1166" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href=""></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href=""></a></span>
<span id="cb1-3"><a href=""></a>A <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">3</span>, <span class="dv">4</span>]])</span>
<span id="cb1-4"><a href=""></a>eigenvalues <span class="op">=</span> np.linalg.eigvals(A)</span>
<span id="cb1-5"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Matrix A:"</span>)</span>
<span id="cb1-6"><a href=""></a><span class="bu">print</span>(A)</span>
<span id="cb1-7"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Eigenvalues of A: </span><span class="sc">{</span>eigenvalues<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Matrix A:
[[1 2]
 [3 4]]
Eigenvalues of A: [-0.37228132  5.37228132]</code></pre>
</div>
</div>
</section>
<section id="singular-value-decomposition-i" class="slide level2">
<h2>Singular Value Decomposition I</h2>
<p>Every real <span class="math inline">\(n\)</span> by <span class="math inline">\(m\)</span> matrix <span class="math inline">\(A\)</span> has a (non-unique) <strong>Singular Value Decomposition</strong> (SVD): <span class="math display">\[
  A = U D V^T,
\]</span> where <span class="math inline">\(U\)</span> is a <span class="math inline">\(n\)</span> by <span class="math inline">\(n\)</span> matrix, <span class="math inline">\(D\)</span> is a <span class="math inline">\(n\)</span> by <span class="math inline">\(m\)</span> matrix and <span class="math inline">\(V\)</span> is a <span class="math inline">\(m\)</span> by <span class="math inline">\(m\)</span> matrix. Matrices <span class="math inline">\(U\)</span> and <span class="math inline">\(V\)</span> are orthogonal, i.e.&nbsp;<span class="math inline">\(UU^T=I\)</span> and <span class="math inline">\(VV^T=I\)</span> and <span class="math inline">\(D\)</span> is a diagonal matrix with non-negative entires.</p>
<p>Algorithms for computing SVD can be found on <a href="https://en.wikipedia.org/wiki/Singular_value_decomposition#Calculating_the_SVD">wikipedia</a>.</p>
</section>
<section id="singular-value-decomposition-ii" class="slide level2">
<h2>Singular Value Decomposition II</h2>
<ul>
<li>Example: <span class="math display">\[
A = \begin{pmatrix}
1 &amp; 0 &amp; 0 &amp; 0 &amp; 2\\
0 &amp; 0 &amp; 3 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 2 &amp; 0 &amp; 0 &amp; 0
\end{pmatrix},
\]</span></li>
</ul>
</section>
<section id="singular-value-decomposition-iii" class="slide level2">
<h2>Singular Value Decomposition III</h2>
<p>then <span class="math display">\[
U = \begin{pmatrix}
0 &amp; -1 &amp; 0 &amp; 0\\
-1 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; -1\\
0 &amp; 0 &amp; -1 &amp; 0
\end{pmatrix}, \
M = \begin{pmatrix}
3 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; \sqrt{5} &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 2 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0
\end{pmatrix}
\]</span></p>
</section>
<section id="singular-value-decomposition-iv" class="slide level2">
<h2>Singular Value Decomposition IV</h2>
<p>and <span class="math display">\[
V^T = \begin{pmatrix}
0 &amp; 0 &amp; -1 &amp; 0 &amp; 0\\
-\sqrt{0.2} &amp; 0 &amp; 0 &amp; 0 &amp; -\sqrt{0.8}\\
0 &amp; -1 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 1 &amp; 0\\
-\sqrt{0.8} &amp; 0 &amp; 0 &amp; 0 &amp; \sqrt{0.2}
\end{pmatrix}.
\]</span></p>
</section>
<section id="singular-value-decomposition-v" class="slide level2">
<h2>Singular Value Decomposition V</h2>
<p>The non-zero entries of <span class="math inline">\(M\)</span> are the square roots of the eigenvalues of the square matrix <span class="math inline">\(AA^T,\)</span> they are called the <strong>singular values</strong> of <span class="math inline">\(A,\)</span> hence the name of the decomposition.</p>
<p>Note that the eigenvalues of <span class="math inline">\(AA^T\)</span> must be real and non-negative, because <span class="math inline">\(AA^T\)</span> is self-adjoint (with respect to the usual Euclidean norm) and positive semi-definite. Hence, singular values are well defined.</p>
</section>
<section id="singular-value-decomposition-vi" class="slide level2">
<h2>Singular Value Decomposition VI</h2>
<p>Usually SVD is chosen so that the non-zero values of <span class="math inline">\(M\)</span> would be arranged from largest to smallest.</p>
<p>One application of SVD is data compression. Let’s say the data is represented by a matrix <span class="math inline">\(A\)</span>. The procedure is as follows:</p>
<ol type="1">
<li>Compute the SVD of <span class="math inline">\(A.\)</span></li>
<li>Cut off <span class="math inline">\(i\)</span> smallest singular values from <span class="math inline">\(M\)</span></li>
<li>Multiply back to get the matrix <span class="math inline">\(A'\)</span>. <span class="math inline">\(A'\)</span> is then the compressed version of <span class="math inline">\(A\)</span></li>
</ol>
</section>
<section id="singular-value-decomposition-vii" class="slide level2">
<h2>Singular Value Decomposition VII</h2>
<p>This procedure is well illustrated by the following picture:</p>

<img data-src="../images/svd-and-rank-k-approximations-l.jpg" class="quarto-figure quarto-figure-center r-stretch"><p>Let’s see some applications of this idea.</p>
</section>
<section id="svd-compressing-images-i" class="slide level2">
<h2>SVD: Compressing images I</h2>
<p>A digital image is just a matrix of pixels. If the image is in black and white then each pixel can be represented by a single number and thus the whole image can be represented by a matrix.</p>
<p>If an image is in color, then each pixel is represented by three numbers, its RGB (red, green, blue) values.</p>
<p>For simplicity, we will stick with black and white images.</p>
</section>
<section id="svd-compressing-images-ii" class="slide level2">
<h2>SVD: Compressing images II</h2>
<div id="e60fe2e2" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href=""></a><span class="im">from</span> PIL <span class="im">import</span> Image <span class="co"># Library for handling images</span></span>
<span id="cb3-2"><a href=""></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb3-3"><a href=""></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-4"><a href=""></a></span>
<span id="cb3-5"><a href=""></a><span class="kw">def</span> show(X):</span>
<span id="cb3-6"><a href=""></a>  <span class="co">"""Function for displaying image from numpy array"""</span></span>
<span id="cb3-7"><a href=""></a>  m <span class="op">=</span> <span class="dv">255</span> <span class="cf">if</span> X.<span class="bu">max</span>() <span class="op">&gt;</span> <span class="dv">1</span> <span class="cf">else</span> <span class="dv">1</span></span>
<span id="cb3-8"><a href=""></a>  plt.imshow(X, cmap<span class="op">=</span><span class="st">'gray'</span>, vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span>m)</span>
<span id="cb3-9"><a href=""></a>  plt.axis(<span class="st">'off'</span>)</span>
<span id="cb3-10"><a href=""></a></span>
<span id="cb3-11"><a href=""></a>image <span class="op">=</span> np.array(Image.<span class="bu">open</span>(<span class="st">'../images/castle.jpg'</span>).convert(<span class="st">'L'</span>)) <span class="co"># Load the image and save it to a numpy array</span></span>
<span id="cb3-12"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Image resolution: </span><span class="sc">{</span>image<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-13"><a href=""></a>show(image)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</section>
<section id="svd-compressing-images-ii-output" class="slide level2 output-location-slide"><h2>SVD: Compressing images II</h2><div class="cell output-location-slide" data-execution_count="2">
<div class="cell-output cell-output-stdout">
<pre><code>Image resolution: (312, 198)</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="01_applications_of_linear_algebra_files/figure-revealjs/cell-3-output-2.png"></p>
</figure>
</div>
</div>
</div></section><section id="svd-compressing-images-iii" class="slide level2">
<h2>SVD: Compressing images III</h2>
<div id="d4c69f3e" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href=""></a>U, M, V <span class="op">=</span> np.linalg.svd(image) <span class="co"># Compute SVD</span></span>
<span id="cb5-2"><a href=""></a><span class="co"># Note that in the output V is already transposed, i.e. you do not need to transpose it manually</span></span>
<span id="cb5-3"><a href=""></a><span class="co"># Also M is given by an array instead of a matrix, indeed</span></span>
<span id="cb5-4"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Shape of U: </span><span class="sc">{</span>U<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb5-5"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Shape of M: </span><span class="sc">{</span>M<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb5-6"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Shape of V: </span><span class="sc">{</span>V<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Shape of U: (312, 312)
Shape of M: (198,)
Shape of V: (198, 198)</code></pre>
</div>
</div>
</section>
<section id="svd-compressing-images-iv" class="slide level2">
<h2>SVD: Compressing images IV</h2>
<p>Let’s try applying the idea we discussed to compress the image.</p>
<div id="4e56094b" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href=""></a><span class="kw">def</span> size(u, m, v):</span>
<span id="cb7-2"><a href=""></a>  <span class="co">"""Function to compute SVD matrix sizes"""</span></span>
<span id="cb7-3"><a href=""></a>  <span class="cf">return</span> u.shape[<span class="dv">0</span>]<span class="op">*</span>u.shape[<span class="dv">1</span>] <span class="op">+</span> <span class="bu">len</span>(m) <span class="op">+</span> v.shape[<span class="dv">0</span>]<span class="op">*</span>v.shape[<span class="dv">1</span>]</span>
<span id="cb7-4"><a href=""></a></span>
<span id="cb7-5"><a href=""></a>s <span class="op">=</span> <span class="dv">25</span> <span class="co"># Singular values to keep</span></span>
<span id="cb7-6"><a href=""></a><span class="cf">assert</span>(s <span class="op">&lt;=</span> <span class="bu">len</span>(M))</span>
<span id="cb7-7"><a href=""></a></span>
<span id="cb7-8"><a href=""></a>U_comp <span class="op">=</span> U[:, :s] <span class="co"># Truncate the matrices</span></span>
<span id="cb7-9"><a href=""></a>M_comp <span class="op">=</span> M[<span class="dv">0</span>:s]</span>
<span id="cb7-10"><a href=""></a>V_comp <span class="op">=</span> V[:s, :]</span>
<span id="cb7-11"><a href=""></a>image_comp <span class="op">=</span> (U_comp <span class="op">*</span> M_comp) <span class="op">@</span> V_comp <span class="co"># Multiply back; @ is matrix multiplication in numpy</span></span>
<span id="cb7-12"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Compressed image resolution: </span><span class="sc">{</span>image_comp<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb7-13"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Compression rate: </span><span class="sc">{</span><span class="dv">1</span> <span class="op">-</span> size(U_comp, M_comp, V_comp)<span class="op">/</span>size(U, M, V)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb7-14"><a href=""></a>show(image_comp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</section>
<section id="svd-compressing-images-iv-output" class="slide level2 output-location-slide"><h2>SVD: Compressing images IV</h2><div class="cell output-location-slide" data-execution_count="4">
<div class="cell-output cell-output-stdout">
<pre><code>Compressed image resolution: (312, 198)
Compression rate: 0.9065786202155822</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="01_applications_of_linear_algebra_files/figure-revealjs/cell-5-output-2.png"></p>
</figure>
</div>
</div>
</div></section><section id="svd-recommender-system-i" class="slide level2">
<h2>SVD: Recommender System I</h2>
<p>We are going to build a movie recommender system using the following dataset.</p>
<div id="46cde78a" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href=""></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb9-2"><a href=""></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb9-3"><a href=""></a></span>
<span id="cb9-4"><a href=""></a>reviews <span class="op">=</span> pd.read_csv(<span class="st">'../data/movielens/crosstable.csv'</span>, index_col<span class="op">=</span><span class="st">"userId"</span>)</span>
<span id="cb9-5"><a href=""></a>names <span class="op">=</span> reviews.T.index.to_numpy()</span>
<span id="cb9-6"><a href=""></a>reviews</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</section>
<section id="svd-recommender-system-i-output" class="slide level2 output-location-slide"><h2>SVD: Recommender System I</h2><div class="cell output-location-slide" data-execution_count="5">
<div class="cell-output cell-output-display" data-execution_count="5">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">(500) Days of Summer (2009)</th>
<th data-quarto-table-cell-role="th">10 Things I Hate About You (1999)</th>
<th data-quarto-table-cell-role="th">101 Dalmatians (1996)</th>
<th data-quarto-table-cell-role="th">101 Dalmatians (One Hundred and One Dalmatians) (1961)</th>
<th data-quarto-table-cell-role="th">12 Angry Men (1957)</th>
<th data-quarto-table-cell-role="th">2001: A Space Odyssey (1968)</th>
<th data-quarto-table-cell-role="th">21 Jump Street (2012)</th>
<th data-quarto-table-cell-role="th">28 Days Later (2002)</th>
<th data-quarto-table-cell-role="th">300 (2007)</th>
<th data-quarto-table-cell-role="th">3:10 to Yuma (2007)</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">X-Men: First Class (2011)</th>
<th data-quarto-table-cell-role="th">X-Men: The Last Stand (2006)</th>
<th data-quarto-table-cell-role="th">X2: X-Men United (2003)</th>
<th data-quarto-table-cell-role="th">Yes Man (2008)</th>
<th data-quarto-table-cell-role="th">You've Got Mail (1998)</th>
<th data-quarto-table-cell-role="th">Young Frankenstein (1974)</th>
<th data-quarto-table-cell-role="th">Zodiac (2007)</th>
<th data-quarto-table-cell-role="th">Zombieland (2009)</th>
<th data-quarto-table-cell-role="th">Zoolander (2001)</th>
<th data-quarto-table-cell-role="th">Zootopia (2016)</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">userId</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>5.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>3.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.5</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>5.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">606</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>5.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>3.5</td>
<td>3.5</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">607</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">608</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>3.0</td>
<td>0.0</td>
<td>3.5</td>
<td>5.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>4.0</td>
<td>4.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>3.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">609</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">610</td>
<td>3.5</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>4.5</td>
<td>0.0</td>
<td>5.0</td>
<td>4.0</td>
<td>3.5</td>
<td>...</td>
<td>4.0</td>
<td>3.0</td>
<td>4.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>5.0</td>
<td>3.5</td>
<td>4.0</td>
<td>4.0</td>
</tr>
</tbody>
</table>

<p>610 rows × 1000 columns</p>
</div>
</div>
</div></section><section id="svd-recommender-system-ii" class="slide level2">
<h2>SVD: Recommender System II</h2>
<p>That is we have users in rows, movies in columns and values represent a rating that a user gave to a movie (rating is 0 if user has not rated the movie).</p>
<p>Now suppose we compute the SVD of this matrix <span class="math inline">\(U M V^T\)</span>. The matrix <span class="math inline">\(V^T\)</span> stores information on original matrix’s columns, in this case movies. The rows of <span class="math inline">\(V^T\)</span> are eigenvectors of <span class="math inline">\(M^TM\)</span> and they form a basis.</p>
</section>
<section id="svd-recommender-system-iii" class="slide level2">
<h2>SVD: Recommender System III</h2>
<p>The columns of <span class="math inline">\(V^T\)</span> give an embedding of the movies to the linear space spanned by the rows of <span class="math inline">\(V^T\)</span>. I.e. the column that represents a movie gives the coordinates of the movie in this linear space. If we assume that similar people rate similar movies similarly we then get that similar movies should be close to each other in the space.</p>
<p>We can then use this idea to generate recommendations for movies. Let’s see how we could implement this.</p>
</section>
<section id="svd-recommender-system-iv" class="slide level2">
<h2>SVD: Recommender System IV</h2>
<div id="97985a6b" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href=""></a><span class="kw">def</span> find_recommendations(movie_name, data):</span>
<span id="cb10-2"><a href=""></a>  movie_to_compare <span class="op">=</span> data[np.argwhere(names <span class="op">==</span> movie_name)[<span class="dv">0</span>]]</span>
<span id="cb10-3"><a href=""></a>  distances <span class="op">=</span> np.linalg.norm(data <span class="op">-</span> movie_to_compare, axis<span class="op">=</span><span class="dv">1</span>) <span class="co"># Compute the Euclidean distance between the given movie and all others</span></span>
<span id="cb10-4"><a href=""></a>  <span class="cf">return</span> names[distances.argsort()[:<span class="dv">10</span>]] <span class="co"># Take ten movies with lowest distance from given movie</span></span>
<span id="cb10-5"><a href=""></a></span>
<span id="cb10-6"><a href=""></a>U, M, V <span class="op">=</span> np.linalg.svd(reviews, full_matrices<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb10-7"><a href=""></a>V1 <span class="op">=</span> V[:<span class="dv">40</span>].T <span class="co"># Remove noise</span></span>
<span id="cb10-8"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Movies similar to:"</span>)</span>
<span id="cb10-9"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Toy Story: </span><span class="sc">{</span>find_recommendations(<span class="st">'Toy Story (1995)'</span>, V1)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb10-10"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Iron Man: </span><span class="sc">{</span>find_recommendations(<span class="st">'Iron Man (2008)'</span>, V1)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</section>
<section id="svd-recommender-system-iv-output" class="slide level2 output-location-slide"><h2>SVD: Recommender System IV</h2><div class="cell output-location-slide" data-execution_count="6">
<div class="cell-output cell-output-stdout">
<pre><code>Movies similar to:
Toy Story: ['Toy Story (1995)' 'Toy Story 2 (1999)' 'Toy Story 3 (2010)'
 "Bug's Life, A (1998)" 'Inside Out (2015)'
 'Hunchback of Notre Dame, The (1996)' 'James and the Giant Peach (1996)'
 'Escape from L.A. (1996)' 'Monsters, Inc. (2001)' 'Dragonheart (1996)']
Iron Man: ['Iron Man (2008)' 'Kung Fu Panda (2008)' 'Star Trek (2009)'
 'Avatar (2009)' 'Zombieland (2009)'
 "Pirates of the Caribbean: At World's End (2007)" 'Source Code (2011)'
 'Iron Man 2 (2010)' 'Avengers, The (2012)' 'Watchmen (2009)']</code></pre>
</div>
</div></section><section id="svd-linear-regression-i" class="slide level2">
<h2>SVD: Linear Regression I</h2>
<p>Linear regression is a model that approximates a dependent random variable <span class="math inline">\(Y\)</span> by independent random variables <span class="math inline">\(X_1, \ \dots, \ X_m\)</span> using a linear function (more accurately an affine function). I.e. <span class="math display">\[
  Y = \beta_0 + \beta_1 X_1 + \dots + \beta_m X_m + \varepsilon,
\]</span> where <span class="math inline">\(\varepsilon\)</span> is a random variable representing noise.</p>
</section>
<section id="svd-linear-regression-ii" class="slide level2">
<h2>SVD: Linear Regression II</h2>
<p>Let’s say we have <span class="math inline">\(n\)</span> observations <span class="math inline">\((y_i, x_{i1}, \dots, x_{im})_{i=1}^n.\)</span> Denote <span class="math display">\[
  Y = \begin{pmatrix}
y_1 \\
\dots \\
y_n
\end{pmatrix}, \ X = \begin{pmatrix}
1 &amp; x_{11} &amp; \dots &amp; x_{1m}\\
\dots \\
1 &amp; x_{n1} &amp; \dots &amp; x_{nm}
\end{pmatrix}, \ \beta = \begin{pmatrix}
\beta_0 \\
\dots \\
\beta_m
\end{pmatrix}.
\]</span></p>
</section>
<section id="svd-linear-regression-iii" class="slide level2">
<h2>SVD: Linear Regression III</h2>
<p>One approach to fitting a linear regression model to this data is to find <span class="math inline">\(\beta\)</span> that minimizes <span class="math display">\[
  \left\lVert X\beta-Y \right\rVert^2.
\]</span></p>
<p>This is called least-squares estimate. It can easily be shown that such a <span class="math inline">\(\beta\)</span> is equal to <span class="math display">\[(X^TX)^{-1}X^TY.\]</span></p>
<p>Usually, in implementations of linear regression, <span class="math inline">\(\beta\)</span> is computed using SVD.</p>
<p>Let <span class="math inline">\(X=UMV^T\)</span> be the SVD of <span class="math inline">\(X.\)</span> Then, <span class="math display">\[
  \beta = (X^TX)^{-1}X^TY = VM^{-1}U^TY.
\]</span></p>
</section>
<section id="svd-linear-regression-iv" class="slide level2">
<h2>SVD: Linear Regression IV</h2>
<p>Let’s fit a linear regression model using SVD. We are going to use the diabetes dataset that ships with <code>sklearn</code>.</p>
<div id="6fc8f953" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href=""></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> load_diabetes</span>
<span id="cb12-2"><a href=""></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> root_mean_squared_error</span>
<span id="cb12-3"><a href=""></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb12-4"><a href=""></a></span>
<span id="cb12-5"><a href=""></a>X <span class="op">=</span> load_diabetes().data</span>
<span id="cb12-6"><a href=""></a>Y <span class="op">=</span> load_diabetes().target</span>
<span id="cb12-7"><a href=""></a>n, m <span class="op">=</span> X.shape</span>
<span id="cb12-8"><a href=""></a>X_with_ones <span class="op">=</span> np.hstack([np.ones(n)[:, np.newaxis], X]) <span class="co"># Add ones to dataset </span></span>
<span id="cb12-9"><a href=""></a></span>
<span id="cb12-10"><a href=""></a>U, M, V <span class="op">=</span> np.linalg.svd(X_with_ones)</span>
<span id="cb12-11"><a href=""></a>beta <span class="op">=</span> (((V.T<span class="op">*</span>np.reciprocal(M))) <span class="op">@</span> U[:, :<span class="bu">len</span>(M)].T) <span class="op">@</span> Y.T</span>
<span id="cb12-12"><a href=""></a></span>
<span id="cb12-13"><a href=""></a>Y_svd <span class="op">=</span> X_with_ones <span class="op">@</span> beta.T</span>
<span id="cb12-14"><a href=""></a></span>
<span id="cb12-15"><a href=""></a><span class="bu">print</span>(<span class="ss">f"RMSE with our fit: </span><span class="sc">{</span>root_mean_squared_error(Y, Y_svd)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>RMSE with our fit: 53.476128764026576</code></pre>
</div>
</div>
</section>
<section id="svd-linear-regression-v" class="slide level2">
<h2>SVD: Linear Regression V</h2>
<p>Let’s compare our fit to the one provided by <code>sklearn's</code> linear regression model.</p>
<div id="644ebd1f" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href=""></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb14-2"><a href=""></a></span>
<span id="cb14-3"><a href=""></a>model <span class="op">=</span> LinearRegression()</span>
<span id="cb14-4"><a href=""></a>model.fit(X, Y) <span class="co"># You do not need to append 1 to X when using sklearn's function</span></span>
<span id="cb14-5"><a href=""></a>Y_sklearn <span class="op">=</span> model.predict(X)</span>
<span id="cb14-6"><a href=""></a></span>
<span id="cb14-7"><a href=""></a><span class="bu">print</span>(<span class="ss">f"RMSE with sklearn: </span><span class="sc">{</span>root_mean_squared_error(Y, Y_sklearn)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb14-8"><a href=""></a><span class="bu">print</span>(<span class="ss">f"RMSE between our fit and sklearn: </span><span class="sc">{</span>root_mean_squared_error(Y_svd, Y_sklearn)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>RMSE with sklearn: 53.47612876402657
RMSE between our fit and sklearn: 8.860957917960832e-14</code></pre>
</div>
</div>
<p>The results are the same (up to rounding errors) as they should be. <code>sklearn</code> also uses SVD under the hood to fit linear regression.</p>
</section>
<section id="svd-principal-component-analysis-i" class="slide level2">
<h2>SVD: Principal Component Analysis I</h2>
<p><strong>Principal Component Analysis</strong> (PCA) is a technique for reducing the dimensionality of data.</p>
<p>Suppose you have <span class="math inline">\(n\)</span> samples of <span class="math inline">\(m\)</span> variables. PCA allows you to compress those <span class="math inline">\(m\)</span> variables into let’s say <span class="math inline">\(k\)</span> variables, where <span class="math inline">\(k &lt; n\)</span>. Hopefully, this compression also removes noise from your dataset.</p>
<p>We will not go into the mathematics behind PCA, the goal is only to showcase what you can accomplish utilizing data compression. Good place to start reading up on PCA is the <a href="https://en.wikipedia.org/wiki/Principal_component_analysis">wikipedia article</a>.</p>
</section>
<section id="svd-principal-component-analysis-ii" class="slide level2">
<h2>SVD: Principal Component Analysis II</h2>
<p>You can perform PCA as follows:</p>
<ol type="1">
<li>Centralize your variables, that is from each observation of your variable subtract the sample mean of that variable (so that the sample mean of the variable becomes 0).</li>
<li>Form a matrix <span class="math inline">\(A\)</span> where rows represent samples and columns represent variables.</li>
<li>Compute SVD of <span class="math inline">\(A = UMV^T.\)</span></li>
<li>Keep only first <span class="math inline">\(k\)</span> singular values and truncate <span class="math inline">\(U\)</span> appropriately.</li>
</ol>
</section>
<section id="svd-principal-component-analysis-iii" class="slide level2">
<h2>SVD: Principal Component Analysis III</h2>
<ol start="5" type="1">
<li>Multiply the truncated <span class="math inline">\(U\)</span> and <span class="math inline">\(M\)</span> together, you will get a matrix with <span class="math inline">\(n\)</span> rows and <span class="math inline">\(k\)</span> columns. The rows still represent samples and columns represent the compressed variables.</li>
</ol>
<p>Let’s apply PCA to the diabetes dataset. <code>sklearn</code> has an implementation of PCA, which also performs step 1 automatically, i.e.&nbsp;you do not have to provide centralized data.</p>
</section>
<section id="svd-principal-component-analysis-iv" class="slide level2">
<h2>SVD: Principal Component Analysis IV</h2>
<div id="2d889851" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href=""></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> load_diabetes</span>
<span id="cb16-2"><a href=""></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> root_mean_squared_error</span>
<span id="cb16-3"><a href=""></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb16-4"><a href=""></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA</span>
<span id="cb16-5"><a href=""></a></span>
<span id="cb16-6"><a href=""></a>X <span class="op">=</span> load_diabetes().data</span>
<span id="cb16-7"><a href=""></a>Y <span class="op">=</span> load_diabetes().target</span>
<span id="cb16-8"><a href=""></a></span>
<span id="cb16-9"><a href=""></a>pca <span class="op">=</span> PCA(n_components<span class="op">=</span><span class="dv">5</span>, random_state<span class="op">=</span><span class="dv">34</span>)</span>
<span id="cb16-10"><a href=""></a>X_compressed <span class="op">=</span> pca.fit_transform(X)</span>
<span id="cb16-11"><a href=""></a></span>
<span id="cb16-12"><a href=""></a>model <span class="op">=</span> LinearRegression()</span>
<span id="cb16-13"><a href=""></a>model.fit(X_compressed, Y) <span class="co"># You do not need to append 1 to X when using sklearn's function</span></span>
<span id="cb16-14"><a href=""></a>Y_pred <span class="op">=</span> model.predict(X_compressed)</span>
<span id="cb16-15"><a href=""></a><span class="bu">print</span>(<span class="ss">f"RMSE: </span><span class="sc">{</span>root_mean_squared_error(Y, Y_pred)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>RMSE: 54.430712061822824</code></pre>
</div>
</div>
<p>We did not get any improvement to our fit in this case, but its a good technique to keep in mind none the less.</p>
</section>
<section id="pca-anomaly-detection-i" class="slide level2">
<h2>PCA: Anomaly Detection I</h2>
<p>Performing PCA actually gives us a (linear) function for encoding data, let’s call it <span class="math inline">\(E\)</span>. It also gives us a function for decoding data, let’s call it <span class="math inline">\(D.\)</span> Of course, <span class="math inline">\(D\)</span> is not perfect, i.e.&nbsp;if we encode a vector <span class="math inline">\(x\)</span> and then decode it we are not going to get a vector equal to <span class="math inline">\(x\)</span>.</p>
<p>Let’s define reconstruction error to be the Euclidean distance between <span class="math inline">\(x\)</span> and <span class="math inline">\(D(E(x)),\)</span> that is I encode <span class="math inline">\(x\)</span>, decode it and compare what I get to the original <span class="math inline">\(x\)</span> to get the reconstruction error.</p>
</section>
<section id="pca-anomaly-detection-ii" class="slide level2">
<h2>PCA: Anomaly Detection II</h2>
<p>The reconstruction error is going to be the lowest when <span class="math inline">\(x\)</span> is very similar to the initial data we used to fit our PCA. We can utilize this to detect anomalies as follows:</p>
<ol type="1">
<li>Take typical examples of your data and use it to fit PCA.</li>
<li>When new data comes in compute its reconstruction error. If it is unusually high it is a good indication that you just received an anomaly.</li>
</ol>
</section>
<section id="pca-anomaly-detection-iii" class="slide level2">
<h2>PCA: Anomaly Detection III</h2>
<p>Try to implement this idea yourselves. Here is some code to get you started.</p>
<div id="473350b8" class="cell columns column-output-location" data-execution_count="10">
<div class="column">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href=""></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> fetch_olivetti_faces</span>
<span id="cb18-2"><a href=""></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA</span>
<span id="cb18-3"><a href=""></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb18-4"><a href=""></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb18-5"><a href=""></a></span>
<span id="cb18-6"><a href=""></a><span class="kw">def</span> show(X, height<span class="op">=</span><span class="dv">64</span>, width<span class="op">=</span><span class="dv">64</span>):</span>
<span id="cb18-7"><a href=""></a>  <span class="co">"""Function for displaying image from numpy array"""</span></span>
<span id="cb18-8"><a href=""></a>  m <span class="op">=</span> <span class="dv">255</span> <span class="cf">if</span> X.<span class="bu">max</span>() <span class="op">&gt;</span> <span class="dv">1</span> <span class="cf">else</span> <span class="dv">1</span></span>
<span id="cb18-9"><a href=""></a>  plt.imshow(np.reshape(X, shape<span class="op">=</span>(height, width)), cmap<span class="op">=</span><span class="st">'gray'</span>, vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span>m)</span>
<span id="cb18-10"><a href=""></a>  plt.axis(<span class="st">'off'</span>)</span>
<span id="cb18-11"><a href=""></a>  plt.show()</span>
<span id="cb18-12"><a href=""></a></span>
<span id="cb18-13"><a href=""></a>faces <span class="op">=</span> fetch_olivetti_faces()[<span class="st">"data"</span>]</span>
<span id="cb18-14"><a href=""></a>regular, anomalies, train <span class="op">=</span> faces[:<span class="dv">10</span>], np.flip(faces[<span class="dv">10</span>:<span class="dv">20</span>], axis<span class="op">=</span><span class="dv">1</span>), faces[<span class="dv">20</span>:]</span>
<span id="cb18-15"><a href=""></a></span>
<span id="cb18-16"><a href=""></a><span class="bu">print</span>(<span class="st">"Regular face and anomaly:"</span>)</span>
<span id="cb18-17"><a href=""></a>show(np.array([<span class="op">*</span>regular[<span class="dv">0</span>], <span class="op">*</span>anomalies[<span class="dv">0</span>]]), height<span class="op">=</span><span class="dv">128</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code>Regular face and anomaly:</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="01_applications_of_linear_algebra_files/figure-revealjs/cell-11-output-2.png"></p>
</figure>
</div>
</div>
</div></div>
</section>
<section id="pca-anomaly-detection-iv" class="slide level2">
<h2>PCA: Anomaly Detection IV</h2>
<p>Take the faces in the train array and use them to fit PCA. Then compute the reconstruction error for the unmodified faces in the regular array and flipped faces in the anomalies array. Check if you can see the difference in reconstruction errors.</p>
<p>Might be useful:</p>
<ul>
<li><a href="https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.PCA.html"><code>sklearn's</code> PCA documentation</a>.</li>
<li>You can compute the Euclidean norm using the <code>np.linalg.norm</code> function.</li>
</ul>

</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="01_applications_of_linear_algebra_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="01_applications_of_linear_algebra_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="01_applications_of_linear_algebra_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="01_applications_of_linear_algebra_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="01_applications_of_linear_algebra_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="01_applications_of_linear_algebra_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="01_applications_of_linear_algebra_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="01_applications_of_linear_algebra_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="01_applications_of_linear_algebra_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="01_applications_of_linear_algebra_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>